= 401 Unauthorized
:sectnums:

link:index.adoc[Back to Error Reference]

== Summary

[cols="1,3"]
|===
| Status | `401`
| Title | Unauthorized
| Produced by | `ProblemDetail.unauthorized()`
|===

== Description

Authentication is required but was not provided or is invalid.
The gateway expects a valid JWT Bearer token in the `Authorization` header
for all requests. Token validation is delegated to the configured
`JwtIssuerConfigService` controller service.

== Common Causes

* Missing `Authorization` header
* Malformed `Authorization` header (not `Bearer <token>` format)
* Expired JWT token
* Invalid token signature
* Token issued by an unknown or untrusted issuer
* Insufficient scopes for the requested route (step-up authentication required)

== Example Response

[source,json]
----
{
  "type": "https://github.com/cuioss/nifi-extensions/blob/main/doc/rest-errors/unauthorized.adoc",
  "title": "Unauthorized",
  "status": 401,
  "detail": "Missing or malformed Authorization header"
}
----

== Resolution

Include a valid JWT Bearer token in the `Authorization` header:

[source]
----
Authorization: Bearer <valid-jwt-token>
----

Ensure the token is issued by a trusted issuer configured in the
`JwtIssuerConfigService` and has not expired.

== See Also

* link:forbidden.adoc[403 Forbidden] -- When authentication succeeds but authorization fails
* link:index.adoc[Error Reference Index]
