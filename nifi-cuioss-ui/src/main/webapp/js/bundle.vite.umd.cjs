(function(g,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("cash-dom"),require("nf.Common"),require("tippy.js")):typeof define=="function"&&define.amd?define(["exports","cash-dom","nf.Common","tippy.js"],a):(g=typeof globalThis<"u"?globalThis:g||self,a(g.nifiCuiossUI={},g.cash,g.nfCommon,g.tippy))})(this,function(g,a,ue,ze){"use strict";function Be(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const s in t)if(s!=="default"){const n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,n.get?n:{enumerable:!0,get:()=>t[s]})}}return e.default=t,Object.freeze(e)}const y=Be(ue),_={DEBUG:0,INFO:1,WARN:2,ERROR:3,FATAL:4},Ke=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"||window.location.hostname.startsWith("192.168.")||window.location.hostname.endsWith(".local")||window.location.search.includes("debug=true")||localStorage.getItem("nifi-debug")==="true"?_.DEBUG:_.WARN;class K{constructor(e="NiFi-UI",s=Ke){this.component=e,this.logLevel=s,this.startTime=Date.now()}_getTimestamp(){const e=new Date,s=e.getTime()-this.startTime;return`[${e.toISOString()}] (+${s}ms)`}_formatMessage(e,s,...n){return[`${this._getTimestamp()} [${e}] ${this.component}:`,s,...n]}_shouldLog(e){return e>=this.logLevel}debug(e,...s){this._shouldLog(_.DEBUG)&&console.debug(...this._formatMessage("DEBUG",e,...s))}info(e,...s){this._shouldLog(_.INFO)&&console.info(...this._formatMessage("INFO",e,...s))}warn(e,...s){this._shouldLog(_.WARN)&&console.warn(...this._formatMessage("WARN",e,...s))}error(e,...s){this._shouldLog(_.ERROR)&&console.error(...this._formatMessage("ERROR",e,...s))}fatal(e,...s){this._shouldLog(_.FATAL)&&console.error(...this._formatMessage("FATAL",e,...s))}child(e){return new K(`${this.component}:${e}`,this.logLevel)}setLogLevel(e){this.logLevel=e}time(e){const s=performance.now();return this.debug(`Starting operation: ${e}`),()=>{const n=performance.now()-s;this.debug(`Operation completed: ${e} (${n.toFixed(2)}ms)`)}}}const k=new K("NiFi-UI"),Je=t=>new K(t);typeof window<"u"&&(window.nifiDebug={enable:()=>{localStorage.setItem("nifi-debug","true"),k.setLogLevel(_.DEBUG),k.info("Debug logging enabled")},disable:()=>{localStorage.removeItem("nifi-debug"),k.setLogLevel(_.WARN),k.info("Debug logging disabled")},setLevel:t=>{k.setLogLevel(t),k.info(`Log level set to: ${Object.keys(_)[t]}`)}});const We=t=>t.map(e=>typeof e=="string"?e:e.msg||"Error detail missing").join(", "),pe=t=>t?typeof t.message=="string"?t.message:Array.isArray(t.errors)&&t.errors.length>0?We(t.errors):null:null,He=t=>{if(!t)return null;try{const e=JSON.parse(t),s=pe(e);return s!==null?s:t}catch(e){return console.debug("Failed to parse responseText as JSON:",e),t}},W=(t,e)=>{if(t==null)return e["processor.jwt.unknownError"]||"Unknown error";const s=String(t),n=s.trim(),i=s.toLowerCase();return n===""||i==="null"||i==="undefined"?e["processor.jwt.unknownError"]||"Unknown error":t},$e=(t,e)=>{if(!t)return e["processor.jwt.unknownError"]||"Unknown error";const s=pe(t.responseJSON);if(s)return W(s,e);const n=He(t.responseText);if(n)return W(n,e);const i=t.statusText||t.message;return W(i,e)},S=(t,e,s,n="processor.jwt.validationError",i={})=>{const{type:o="error",closable:r=!1,autoHide:l=!1}=i,c=$e(e,s),p=s[n]||"Error",O=`
        <div class="error-message ${Ge(o)} ${r?"closable":""}">
            <div class="error-content">
                <strong>${p}:</strong> ${c}
            </div>
            ${r?'<button class="close-error" aria-label="Close error">&times;</button>':""}
        </div>
    `;t.html(O),r&&t.find(".close-error").on("click",()=>{t.find(".error-message").fadeOut(300,function(){this.remove()})}),l&&setTimeout(()=>{t.find(".error-message").fadeOut(300,function(){this.remove()})},5e3)},H=(t,e,s={})=>{const{autoHide:n=!0}=s,o=`
        <div class="success-message ${n?"auto-dismiss":""}">
            <div class="success-content">${e}</div>
        </div>
    `;t.html(o),n&&setTimeout(()=>{t.find(".success-message").remove()},5e3)},Ge=t=>{switch(t){case"validation":return"validation-error";case"network":return"network-error";case"server":return"server-error";default:return""}},fe=t=>{const{title:e,message:s,confirmText:n="Delete",cancelText:i="Cancel",type:o="danger",onConfirm:r,onCancel:l}=t;return new Promise(c=>{a(".confirmation-dialog").remove();const p=qe(e,s,n,i,o),m=a(p);a("body").append(m),Ye(m,c,r,l),requestAnimationFrame(()=>{m.addClass("show"),m.find(".confirm-button").focus()})})},qe=(t,e,s,n,i)=>{const o=Xe(i),r=Qe(i);return`
        <div class="confirmation-dialog ${o}">
            <div class="dialog-overlay"></div>
            <div class="dialog-content">
                <div class="dialog-header">
                    <div class="dialog-icon">${r}</div>
                    <h3 class="dialog-title">${t}</h3>
                </div>
                <div class="dialog-body">
                    <p class="dialog-message">${e}</p>
                </div>
                <div class="dialog-footer">
                    <button class="cancel-button">${n}</button>
                    <button class="confirm-button ${i}-button">${s}</button>
                </div>
            </div>
        </div>
    `},Ye=(t,e,s,n)=>{const i=()=>{ge(t),s&&s(),e(!0)},o=()=>{ge(t),n&&n(),e(!1)};t.find(".confirm-button").on("click",i),t.find(".cancel-button").on("click",o),t.find(".dialog-overlay").on("click",o),t.on("keydown",r=>{r.key==="Escape"?(r.preventDefault(),o()):r.key==="Enter"&&r.target.classList.contains("confirm-button")&&(r.preventDefault(),i())}),Ze(t)},ge=t=>{t.removeClass("show"),setTimeout(()=>{t.remove()},300)},Ze=t=>{const e=t.find('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),s=e.first(),n=e.last();t.on("keydown",i=>{i.key==="Tab"&&(i.shiftKey?document.activeElement===s[0]&&(i.preventDefault(),n.focus()):document.activeElement===n[0]&&(i.preventDefault(),s.focus()))})},Xe=t=>{switch(t){case"danger":return"dialog-danger";case"warning":return"dialog-warning";case"info":return"dialog-info";default:return"dialog-danger"}},Qe=t=>{switch(t){case"danger":return"ðŸ—‘ï¸";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";default:return"ðŸ—‘ï¸"}},et=(t,e)=>fe({title:"Remove Issuer Configuration",message:`Are you sure you want to remove the issuer "${t}"? This action cannot be undone.`,confirmText:"Remove",cancelText:"Cancel",type:"danger",onConfirm:e}),tt=t=>fe({title:"Clear Form Data",message:"Are you sure you want to clear all form data? Any unsaved changes will be lost.",confirmText:"Clear",cancelText:"Cancel",type:"warning",onConfirm:t}),w={BASE_URL:"../nifi-api/processors/jwt",NIFI_BASE_URL:"../nifi-api/processors",ENDPOINTS:{VALIDATE_JWKS_URL:"/validate-jwks-url",VERIFY_TOKEN:"/verify-token",GET_ISSUER_CONFIG:"/issuer-config",SET_ISSUER_CONFIG:"/issuer-config",JWKS_VALIDATE_URL:"../nifi-api/processors/jwks/validate-url",JWT_VERIFY_TOKEN:"../nifi-api/processors/jwt/verify-token"},TIMEOUTS:{DEFAULT:5e3,LONG_OPERATION:1e4,SHORT_OPERATION:2e3,DIALOG_DELAY:500,UI_FALLBACK_TIMEOUT:3e3,TOKEN_CACHE_DURATION:36e5,ERROR_DISPLAY_TIMEOUT:5e3}},d={CLASSES:{SUCCESS_MESSAGE:"success-message",ERROR_MESSAGE:"error-message",WARNING_MESSAGE:"warning-message",LOADING:"loading",HIDDEN:"hidden",DISABLED:"disabled",INVALID:"invalid",VALID:"valid",PROPERTY_LABEL:"property-label",HELP_TOOLTIP:"help-tooltip",PROCESSOR_DIALOG:"processor-dialog",PROCESSOR_TYPE:"processor-type",JWT_VALIDATOR_TITLE:"jwt-validator-title",FA:"fa",FA_QUESTION_CIRCLE:"fa-question-circle"},SELECTORS:{ERROR_CONTAINER:".error-container",SUCCESS_CONTAINER:".success-container",LOADING_INDICATOR:".loading-indicator",FORM_GROUP:".form-group",INPUT_FIELD:".input-field",BUTTON:".button",TOOLTIP:".tooltip",PROPERTY_LABEL:".property-label",HELP_TOOLTIP:".help-tooltip",PROCESSOR_DIALOG:".processor-dialog",PROCESSOR_TYPE:".processor-type",JWT_VALIDATOR_TITLE:".jwt-validator-title"},IDS:{LOADING_INDICATOR:"loading-indicator",JWT_VALIDATOR_TABS:"jwt-validator-tabs"},ISSUER_CONFIG:{CONTAINER:"issuer-config-editor",ISSUERS_CONTAINER:"issuers-container",GLOBAL_ERROR_MESSAGES:"global-error-messages",ADD_ISSUER_BUTTON:"add-issuer-button",REMOVE_ISSUER_BUTTON:"remove-issuer-button",SAVE_ISSUER_BUTTON:"save-issuer-button",ISSUER_FORM:"issuer-form",FORM_HEADER:"form-header",FORM_FIELDS:"form-fields"},TOKEN_VERIFIER:{CONTAINER:"token-verification-container",INPUT_SECTION:"token-input-section",RESULTS_SECTION:"token-results-section",TOKEN_INPUT:"token-input",VERIFY_BUTTON:"verify-token-button",RESULTS_CONTENT:"token-results-content",TOKEN_ERROR:"token-error",TOKEN_LOADING:"token-loading",TOKEN_VALID:"token-valid",TOKEN_INVALID:"token-invalid",TOKEN_DETAILS:"token-details",TOKEN_ERROR_DETAILS:"token-error-details",TOKEN_ERROR_MESSAGE:"token-error-message",TOKEN_ERROR_CATEGORY:"token-error-category",TOKEN_RAW_CLAIMS:"token-raw-claims",TOKEN_CLAIMS_TABLE:"token-claims-table",TOKEN_INSTRUCTIONS:"token-instructions"},JWKS_VALIDATOR:{CONTAINER:"jwks-verification-container",BUTTON_WRAPPER:"jwks-button-wrapper",VERIFY_BUTTON:"verify-jwks-button",VERIFICATION_RESULT:"verification-result"}},N={ISSUER_CONFIG_EDITOR:{DEFAULT_ISSUER_NAME:"sample-issuer",SAMPLE_ISSUER_URL:"https://sample-issuer.example.com",SAMPLE_JWKS_URL:"https://sample-issuer.example.com/.well-known/jwks.json",SAMPLE_AUDIENCE:"sample-audience",SAMPLE_CLIENT_ID:"sample-client"}},$={COMPONENT_TABS:{ISSUER_CONFIG:"jwt.validation.issuer.configuration",TOKEN_VERIFICATION:"jwt.validation.token.verification"},PROCESSOR_TYPES:{MULTI_ISSUER_JWT_AUTHENTICATOR:"MultiIssuerJWTTokenAuthenticator"}},G={HELP_TEXT_KEYS:{TOKEN_LOCATION:"property.token.location.help",TOKEN_HEADER:"property.token.header.help",CUSTOM_HEADER_NAME:"property.custom.header.name.help",BEARER_TOKEN_PREFIX:"property.bearer.token.prefix.help",REQUIRE_VALID_TOKEN:"property.require.valid.token.help",JWKS_REFRESH_INTERVAL:"property.jwks.refresh.interval.help",MAXIMUM_TOKEN_SIZE:"property.maximum.token.size.help",ALLOWED_ALGORITHMS:"property.allowed.algorithms.help",REQUIRE_HTTPS_JWKS:"property.require.https.jwks.help"},PROPERTY_LABELS:{"Token Location":"property.token.location.help","Token Header":"property.token.header.help","Custom Header Name":"property.custom.header.name.help","Bearer Token Prefix":"property.bearer.token.prefix.help","Require Valid Token":"property.require.valid.token.help","JWKS Refresh Interval":"property.jwks.refresh.interval.help","Maximum Token Size":"property.maximum.token.size.help","Allowed Algorithms":"property.allowed.algorithms.help","Require HTTPS for JWKS URLs":"property.require.https.jwks.help"},I18N_KEYS:{JWT_VALIDATOR_LOADING:"jwt.validator.loading",JWT_VALIDATOR_TITLE:"jwt.validator.title"}},I={PATTERNS:{URL:new RegExp("^https?:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*([/?#].*)?$"),HTTPS_URL:new RegExp("^https:\\/\\/[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*([/?#].*)?$"),SAFE_STRING:/^[a-zA-Z0-9._-]+$/},LIMITS:{ISSUER_NAME_MIN:2,ISSUER_NAME_MAX:100,AUDIENCE_MAX:500,CLIENT_ID_MAX:200,URL_MAX:2048}};let q=null;const Y=()=>{if(q!==null)return q;if(typeof global<"u"&&typeof global.getIsLocalhost=="function")return global.getIsLocalhost();if(typeof window>"u"||!window.location)return!1;const t=window.location.hostname||"",e=window.location.href||"";return t==="localhost"||t==="127.0.0.1"||t.startsWith("192.168.")||t.endsWith(".local")||e.includes("localhost")||e.includes("127.0.0.1")},me=t=>{q=t===null?null:!!t},v=(t,e={})=>{const s=document.createElement(t);return e.css&&(Array.isArray(e.css)?s.classList.add(...e.css):typeof e.css=="string"&&(s.className=e.css)),e.className&&(s.className=e.className),e.text&&(s.textContent=e.text),e.html&&(e.sanitized===!0?s.innerHTML=e.html:s.textContent=e.html),e.attributes&&Object.entries(e.attributes).forEach(([n,i])=>{s.setAttribute(n,i)}),e.events&&Object.entries(e.events).forEach(([n,i])=>{s.addEventListener(n,i)}),e.children&&e.children.forEach(n=>{n instanceof Element?s.appendChild(n):typeof n=="string"&&s.appendChild(document.createTextNode(n))}),s};class U{constructor(e={}){this.defaultOptions={i18n:e.i18n||{},cssClasses:e.cssClasses||d,validationEnabled:e.validationEnabled!==!1,containerClass:"form-field",labelSuffix:":",showDescriptions:e.showDescriptions!==!1}}createField(e){const{name:s,label:n,description:i,value:o="",type:r="text",required:l=!1,placeholder:c=i,validation:p=null,events:m={},cssClass:A="",helpText:f=null,disabled:O=!1,attributes:de={}}=e,h=this._createFieldContainer(s,A),b=this._createLabel(s,n,l);h.appendChild(b);const E=this._createInput(s,r,o,c,O,de);if(h.appendChild(E),this.defaultOptions.showDescriptions&&i){const C=this._createDescription(i);h.appendChild(C)}if(f){const C=this._createHelpText(f);h.appendChild(C)}this.defaultOptions.validationEnabled&&p&&this._addValidation(E,p),this._attachEventHandlers(E,m);const R=this._createErrorContainer(s);return h.appendChild(R),h}createButton(e){const{text:s,type:n="button",cssClass:i="",variant:o="primary",onClick:r=null,disabled:l=!1,icon:c=null,attributes:p={}}=e,m=["btn",`btn-${o}`,i].filter(Boolean),A={type:n,disabled:l,...p},f=v("button",{css:m,attributes:A});if(c){const O=v("i",{css:["fa",c]});f.appendChild(O),f.appendChild(document.createTextNode(" "))}return f.appendChild(document.createTextNode(s)),r&&f.addEventListener("click",r),f}createSection(e){const{title:s,content:n=[],cssClass:i="",collapsible:o=!1,expanded:r=!0}=e,l=v("div",{css:["form-section",i].filter(Boolean)});if(s){const p=v("div",{css:["form-section-header"],text:s});if(o){const m=v("i",{css:["fa",r?"fa-chevron-down":"fa-chevron-right"]});p.appendChild(m),p.addEventListener("click",()=>this._toggleSection(l)),p.style.cursor="pointer"}l.appendChild(p)}const c=v("div",{css:["form-section-content",!r&&o?"hidden":""].filter(Boolean)});return n.forEach(p=>{p instanceof Element&&c.appendChild(p)}),l.appendChild(c),l}validateContainer(e){const s=e.querySelectorAll("input, textarea, select"),n=[];let i=!0;return s.forEach(o=>{if(o._validate){const r=o._validate();r.isValid||(i=!1,n.push({field:o.name,error:r.error}))}}),{isValid:i,errors:n}}resetContainer(e){e.querySelectorAll("input, textarea, select").forEach(n=>{var o;n.value="",n.classList.remove("valid","invalid");const i=(o=n.parentElement)==null?void 0:o.querySelector(".field-error");i&&(i.classList.add("hidden"),i.textContent="")})}_createFieldContainer(e,s=""){return v("div",{css:[this.defaultOptions.containerClass,`field-container-${e}`,s].filter(Boolean)})}_createLabel(e,s,n){const i=s+this.defaultOptions.labelSuffix+(n?" *":"");return v("label",{text:i,attributes:{for:`field-${e}`},css:["field-label",n?"required":""].filter(Boolean)})}_createInput(e,s,n,i,o,r){const l={id:`field-${e}`,name:e,placeholder:i,disabled:o,...r},c=v(s==="textarea"?"textarea":"input",{css:[`field-${e}`,"form-input"],attributes:l});return s!=="textarea"&&c.setAttribute("type",s),n&&(s==="textarea"?c.textContent=n:c.value=n),c}_createDescription(e){return v("div",{css:["field-description"],text:e})}_createHelpText(e){return v("div",{css:["field-help","help-tooltip"],text:e,attributes:{title:e}})}_createErrorContainer(e){return v("div",{css:[`field-error-${e}`,"field-error","hidden"],attributes:{role:"alert","aria-live":"polite"}})}_addValidation(e,s){const n=()=>{const i=e.value,o=typeof s=="function"?s(i):s.validate(i),r=e.parentElement.querySelector(".field-error");return o.isValid?(e.classList.remove("invalid"),e.classList.add("valid"),r&&(r.classList.add("hidden"),r.textContent="")):(e.classList.remove("valid"),e.classList.add("invalid"),r&&(r.classList.remove("hidden"),r.textContent=o.error||"Invalid input")),o};e.addEventListener("blur",n),e.addEventListener("input",()=>{if(e.classList.contains("invalid")){e.classList.remove("invalid");const i=e.parentElement.querySelector(".field-error");i&&i.classList.add("hidden")}}),e._validate=n}_attachEventHandlers(e,s){Object.entries(s).forEach(([n,i])=>{typeof i=="function"&&e.addEventListener(n,i)})}_toggleSection(e){const s=e.querySelector(".form-section-content"),n=e.querySelector(".fa");s&&n&&(s.classList.toggle("hidden"),n.classList.toggle("fa-chevron-down"),n.classList.toggle("fa-chevron-right"))}}const st=t=>new U().createField(t),nt=t=>new U().createButton(t),it=t=>new U().createSection(t);class ot{static createField(e){return st(e)}static createButton(e){return nt(e)}static createSection(e){return it(e)}static createFactory(e){return new U(e)}}const rt=async(t,e,s,n)=>{try{await at(t,n)}catch(i){throw typeof n=="function"&&n({validate:()=>!1,error:i.message}),i}},at=async(t,e)=>{if(!t)throw new Error("Token verifier element is required");const s=y.getI18n()||{},n=new U({i18n:s}),i=a(`<div class="${d.TOKEN_VERIFIER.CONTAINER}"></div>`),o=a(`<div class="${d.TOKEN_VERIFIER.INPUT_SECTION}"></div>`),r=n.createField({name:"token-input",label:s["processor.jwt.tokenInput"]||"Enter Token",description:s["processor.jwt.tokenInputDescription"]||"Paste your JWT token for verification",placeholder:s["processor.jwt.tokenInputPlaceholder"]||"Paste token here...",type:"textarea",required:!0,cssClass:"token-verifier-field",attributes:{rows:5}}),l=a(n.createButton({text:s["processor.jwt.verifyToken"]||"Verify Token",variant:"primary",cssClass:d.TOKEN_VERIFIER.VERIFY_BUTTON,icon:"fa-check"})),c=a(n.createButton({text:"Clear",variant:"secondary",cssClass:"clear-token-button",icon:"fa-trash"})),p=a('<div class="button-container"></div>');p.append(l[0]).append(c[0]),o.append(r).append(p[0]);const m=a(`<div class="${d.TOKEN_VERIFIER.RESULTS_SECTION}"></div>`),A=a("<h3></h3>").text(s["processor.jwt.verificationResults"]||"Verification Results"),f=a(`<div class="${d.TOKEN_VERIFIER.RESULTS_CONTENT}"></div>`);m.append(A).append(f),i.append(o).append(m),a(t).append(i),l.on("click",()=>{const b=a(r).find("#field-token-input").val().trim();if(!b){f.html(`<div class="${d.TOKEN_VERIFIER.TOKEN_ERROR}">${s["processor.jwt.noTokenProvided"]||"No token provided"}</div>`);return}l.addClass("loading").prop("disabled",!0),Z(f,s);const E=()=>{l.removeClass("loading").prop("disabled",!1)};try{a.ajax({method:"POST",url:w.ENDPOINTS.JWT_VERIFY_TOKEN,data:JSON.stringify({token:b}),contentType:"application/json",dataType:"json",timeout:w.TIMEOUTS.DEFAULT}).then(R=>{E(),X(R,f,s,O,de)}).catch(R=>{E(),ee(R,f,s,O)})}catch(R){E(),te(R,f,s,O)}}),c.on("click",async()=>{const h=a(r).find("#field-token-input"),b=h.val()?h.val().trim():"",E=f.html()||"";if(b||typeof E=="string"&&E.trim().length>0)await tt(()=>{h.val(""),D(f,s)});else{f.html('<div class="info-message">Form is already empty.</div>');const C=setTimeout(()=>{D(f,s)},2e3);typeof window._tokenVerifierTimeouts>"u"&&(window._tokenVerifierTimeouts=[]),window._tokenVerifierTimeouts.push(C)}});const O=(h,b)=>{const E=V(h,b,s,d);f.html(E)},de=(h,b,E)=>{S(b||f,{responseJSON:h},E||s,"processor.jwt.tokenInvalid")};D(f,s),e==null||e({validate:()=>!0})},V=(t,e,s,n)=>{const i=e?" <em>(Simulated response)</em>":"",{roles:o=[],scopes:r=[]}=t,l=o.length>0?`<tr><th>${s["processor.jwt.roles"]||"Roles"}</th><td>${o.join(", ")}</td></tr>`:"",c=r.length>0?`<tr><th>${s["processor.jwt.scopes"]||"Scopes"}</th><td>${r.join(" ")}</td></tr>`:"";return`
        <div class="${n.TOKEN_VERIFIER.TOKEN_VALID}">
            <span class="fa fa-check-circle"></span>
            ${s["processor.jwt.tokenValid"]||"Token is valid"}${i}
        </div>
        <div class="${n.TOKEN_VERIFIER.TOKEN_DETAILS}">
            <h4>${s["processor.jwt.tokenDetails"]||"Token Details"}</h4>
            <table class="${n.TOKEN_VERIFIER.TOKEN_CLAIMS_TABLE}">
                <tr><th>${s["processor.jwt.subject"]||"Subject"}</th><td>${t.subject||""}</td></tr>
                <tr><th>${s["processor.jwt.issuer"]||"Issuer"}</th><td>${t.issuer||""}</td></tr>
                <tr><th>${s["processor.jwt.audience"]||"Audience"}</th><td>${t.audience||""}</td></tr>
                <tr><th>${s["processor.jwt.expiration"]||"Expiration"}</th><td>${t.expiration||""}</td></tr>
                ${l}
                ${c}
            </table>
            <h4>${s["processor.jwt.allClaims"]||"All Claims"}</h4>
            <pre class="${n.TOKEN_VERIFIER.TOKEN_RAW_CLAIMS}">${JSON.stringify(t.claims,null,2)}</pre>
        </div>
    `},D=(t,e)=>{t.html(`
        <div class="${d.TOKEN_VERIFIER.TOKEN_INSTRUCTIONS}">
            ${e["processor.jwt.initialInstructions"]||'Enter a JWT token above and click "Verify Token" to validate it.'}
        </div>
    `)},Z=(t,e)=>{t.html(`
        <div class="${d.TOKEN_VERIFIER.TOKEN_LOADING}">
            <div class="loading-spinner"></div>
            <span class="loading-text">${e["processor.jwt.verifying"]||"Verifying token..."}</span>
        </div>
    `)},X=(t,e,s,n,i)=>{t.valid?n(t,!1):i(t,e,s)},he=t=>{let e=t.statusText||"Error processing request";if(t.responseText)if(typeof t.responseText=="string"&&(t.responseText.trim().startsWith("{")||t.responseText.trim().startsWith("[")))try{const s=JSON.parse(t.responseText);e=(s==null?void 0:s.message)||e}catch(s){console.debug("Failed to parse responseText as JSON:",s)}else typeof t.responseText=="string"&&(e=t.responseText);return e},Te=(t,e)=>{const s=t==null,n=s?"":String(t).trim(),i=s?"":String(t).toLowerCase();return s||n===""||i==="null"||i==="undefined"?e["processor.jwt.unknownError"]||"Unknown error":t||e["processor.jwt.unknownError"]||"Unknown error"},Q=()=>({valid:!0,subject:"user123",issuer:"https://sample-issuer.example.com",audience:"sample-audience",expiration:new Date(Date.now()+36e5).toISOString(),roles:["admin","user"],scopes:["read","write"],claims:{sub:"user123",iss:"https://sample-issuer.example.com",aud:"sample-audience",exp:Math.floor(Date.now()/1e3)+3600,iat:Math.floor(Date.now()/1e3),roles:["admin","user"],scope:"read write",name:"John Doe",email:"john.doe@example.com"}}),ee=(t,e,s,n)=>{const i=he(t);if(console.debug("Extracted error message:",i),Y()){const o=Q();n(o,!0)}else S(e,t,s,"processor.jwt.verificationError")},te=(t,e,s,n)=>{const i=Te(t.message,s);if(console.debug("Sanitized error message:",i),Y()){const o=Q();n(o,!0)}else S(e,t,s,"processor.jwt.verificationError")},lt=Object.freeze(Object.defineProperty({__proto__:null,__setIsLocalhostForTesting:function(t){me(t)},__test:{showInitialInstructions:D,resetUIAndShowLoading:Z,handleTokenVerificationResponse:X,extractErrorMessageFromXHR:he,sanitizeErrorMessage:Te,createSampleTokenResponse:Q,handleTokenVerificationAjaxError:ee,handleTokenVerificationSyncException:te,handleVerifyButtonClick:(t,e,s,n)=>{const i=t.trim();if(!i)return e.html(`<div class="${d.TOKEN_VERIFIER.TOKEN_ERROR}">${s["processor.jwt.noTokenProvided"]||"No token provided"}</div>`),!1;Z(e,s);try{a.ajax({method:"POST",url:w.ENDPOINTS.JWT_VERIFY_TOKEN,data:JSON.stringify({token:i}),contentType:"application/json",dataType:"json",timeout:w.TIMEOUTS.DEFAULT}).then(o=>{n(),X(o,e,s,(r,l)=>{const c=V(r,l,s,d);e.html(c)},(r,l,c)=>{S(l||e,{responseJSON:r},c||s,"processor.jwt.tokenInvalid")})}).catch(o=>{n(),ee(o,e,s,(r,l)=>{const c=V(r,l,s,d);e.html(c)})})}catch(o){n(),te(o,e,s,(r,l)=>{const c=V(r,l,s,d);e.html(c)})}return!0},handleClearButtonClick:(t,e,s,n)=>{const i=!!(t||typeof e=="string"&&e.trim().length>0);return i||(s.html('<div class="info-message">Form is already empty.</div>'),setTimeout(()=>{D(s,n)},2e3)),i},createValidTokenHtml:V},cleanup:()=>{me(null)},init:rt},Symbol.toStringTag,{value:"Module"})),Ee=(t,e,s=null)=>{const n={method:t,url:e,dataType:"json",timeout:w.TIMEOUTS.DEFAULT};return s&&(n.data=JSON.stringify(s),n.contentType="application/json"),a.ajax(n)},se=t=>Ee("GET",`../nifi-api/processors/${t}`),Ie=(t,e)=>se(t).then(s=>{const n={revision:s.revision,component:{id:t,properties:e}};return Ee("PUT",`../nifi-api/processors/${t}`,n)}),x=(t,e=!0)=>{const s=t==null,i=(s?"":String(t)).trim(),o=i===""||i.toLowerCase()==="null"||i.toLowerCase()==="undefined";return e&&(s||o)?{isValid:!1,error:"This field is required.",sanitizedValue:""}:{isValid:!0,sanitizedValue:i}},ct=t=>{const e=x(t);if(!e.isValid)return{isValid:!1,error:"URL is required for processor ID extraction.",sanitizedValue:""};const s=e.sanitizedValue,i=/\/processors\/([a-f0-9-]+)/i.exec(s);return i?{isValid:!0,sanitizedValue:i[1].toLowerCase()}:{isValid:!1,error:"URL does not contain a valid processor ID.",sanitizedValue:""}},ve=(t,e={})=>{const{httpsOnly:s=!1,maxLength:n=I.LIMITS.URL_MAX}=e,i=x(t);if(!i.isValid)return{isValid:!1,error:"URL is required.",sanitizedValue:""};const o=i.sanitizedValue;return o.length>n?{isValid:!1,error:`URL is too long (maximum ${n} characters).`,sanitizedValue:o}:(s?I.PATTERNS.HTTPS_URL:I.PATTERNS.URL).test(o)?{isValid:!0,sanitizedValue:o}:{isValid:!1,error:`Invalid URL format. Must be a valid ${s?"HTTPS":"HTTP/HTTPS"} URL.`,sanitizedValue:o}},dt=t=>{const e=x(t);if(!e.isValid)return{isValid:!1,error:"Issuer name is required.",sanitizedValue:""};const s=e.sanitizedValue;return s.length<I.LIMITS.ISSUER_NAME_MIN?{isValid:!1,error:`Issuer name must be at least ${I.LIMITS.ISSUER_NAME_MIN} characters long.`,sanitizedValue:s}:s.length>I.LIMITS.ISSUER_NAME_MAX?{isValid:!1,error:`Issuer name is too long (maximum ${I.LIMITS.ISSUER_NAME_MAX} characters).`,sanitizedValue:s}:I.PATTERNS.SAFE_STRING.test(s)?{isValid:!0,sanitizedValue:s}:{isValid:!1,error:"Issuer name can only contain letters, numbers, hyphens, underscores, and dots.",sanitizedValue:s}},ut=(t,e=!1)=>{const s=x(t,e);if(!s.isValid)return s;if(!e&&s.sanitizedValue==="")return{isValid:!0,sanitizedValue:""};const n=s.sanitizedValue;return n.length>I.LIMITS.AUDIENCE_MAX?{isValid:!1,error:`Audience is too long (maximum ${I.LIMITS.AUDIENCE_MAX} characters).`,sanitizedValue:n}:{isValid:!0,sanitizedValue:n}},pt=(t,e=!1)=>{const s=x(t,e);if(!s.isValid)return s;if(!e&&s.sanitizedValue==="")return{isValid:!0,sanitizedValue:""};const n=s.sanitizedValue;return n.length>I.LIMITS.CLIENT_ID_MAX?{isValid:!1,error:`Client ID is too long (maximum ${I.LIMITS.CLIENT_ID_MAX} characters).`,sanitizedValue:n}:{isValid:!0,sanitizedValue:n}},ft=t=>{const e=[],s={},n=dt(t.issuerName);n.isValid||e.push(`Issuer Name: ${n.error}`),s.issuerName=n.sanitizedValue;const i=ve(t.issuer,{httpsOnly:!1});i.isValid||e.push(`Issuer URI: ${i.error}`),s.issuer=i.sanitizedValue;const o=ve(t["jwks-url"],{httpsOnly:!1});o.isValid||e.push(`JWKS URL: ${o.error}`),s["jwks-url"]=o.sanitizedValue;const r=ut(t.audience,!1);r.isValid||e.push(`Audience: ${r.error}`),s.audience=r.sanitizedValue;const l=pt(t["client-id"],!1);return l.isValid||e.push(`Client ID: ${l.error}`),s["client-id"]=l.sanitizedValue,e.length>0?{isValid:!1,error:e.join(" "),sanitizedValue:s}:{isValid:!0,sanitizedValue:s}};class gt{constructor(e){this.componentId=e,this.initialized=!1,this.timeouts=new Set}async initialize(e){try{e&&await e(),this.initialized=!0}catch(s){console.debug(s)}}isComponentInitialized(){return this.initialized}setTimeout(e,s){const n=setTimeout(()=>{this.timeouts.delete(n),e()},s);return this.timeouts.add(n),n}destroy(){this.timeouts.forEach(clearTimeout),this.timeouts.clear(),this.initialized=!1}}const T=ue.getI18n()||{};let j=null;const ne=()=>({name:N.ISSUER_CONFIG_EDITOR.DEFAULT_ISSUER_NAME,properties:{issuer:N.ISSUER_CONFIG_EDITOR.SAMPLE_ISSUER_URL,"jwks-url":N.ISSUER_CONFIG_EDITOR.SAMPLE_JWKS_URL,audience:N.ISSUER_CONFIG_EDITOR.SAMPLE_AUDIENCE,"client-id":N.ISSUER_CONFIG_EDITOR.SAMPLE_CLIENT_ID}}),mt=t=>`<span class="success-message">${t}</span>`,ie=(t,e=!1)=>{const s=T["processor.jwt.ok"]||"OK",n=T["processor.jwt.validJwks"]||"Valid JWKS",i=T["processor.jwt.keysFound"]||"keys found",o=e?" <em>(Simulated response)</em>":"";return`${mt(s)} ${n} (${t} ${i})${o}`},ye=t=>{const e={};return Object.entries(t).filter(([s])=>s.startsWith("issuer.")).forEach(([s,n])=>{const i=s.slice(7).split(".");if(i.length===2){const[o,r]=i;e[o]||(e[o]={}),e[o][r]=n}}),e},ht=t=>{var e,s;return((s=(e=t==null?void 0:t[0])==null?void 0:e.value)==null?void 0:s.trim())||""},_e=t=>{const e=s=>{var n,i,o;return!s||s.length===0?"":typeof s.val=="function"?((n=s.val())==null?void 0:n.trim())||"":((o=(i=s[0])==null?void 0:i.value)==null?void 0:o.trim())||""};return{issuerName:e(t.find(".issuer-name")),issuer:e(t.find(".field-issuer")),"jwks-url":e(t.find(".field-jwks-url")),audience:e(t.find(".field-audience")),"client-id":e(t.find(".field-client-id"))}},Tt=()=>a(".global-error-messages"),Et=t=>{const e=a('<div class="issuer-config-editor"></div>');t.append(e);const s=a("<h3>Issuer Configurations</h3>");e.append(s);const n=a("<p>Configure JWT issuers for token validation. Each issuer requires a name and properties like jwks-url and issuer URI.</p>");e.append(n);const i=a('<div class="global-error-messages issuer-form-error-messages" style="display: none;"></div>');e.append(i);const o=a('<div class="issuers-container"></div>');return e.append(o),{$container:e,$issuersContainer:o,$globalErrorContainer:i}},It=(t,e,s=null)=>{const n=a('<button class="add-issuer-button">Add Issuer</button>');t.append(n);const i=()=>{const o=ne();P(e,o.name+"-"+Date.now(),o.properties,s)};n.on("click",i)},vt=async(t,e)=>{const s=F(t);await _t(e,s)},yt=async(t,e)=>{const s=a(t),n=F(e),{$container:i,$issuersContainer:o}=Et(s);It(i,o,n),await vt(e,o)},F=t=>{const e=ct(t);return e.isValid?e.sanitizedValue:""},_t=async(t,e)=>{if(!e){const s=ne();P(t,s.name,s.properties,e);return}try{const n=(await se(e)).properties||{},i=ye(n);Object.keys(i).forEach(o=>{P(t,o,i[o],e)})}catch(s){console.debug(s);const n=ne();P(t,n.name,n.properties,e)}},bt=(t,e)=>{const s=a('<div class="form-header"></div>'),n=a("<label>Issuer Name:</label>");s.append(n);const i=a('<input type="text" class="issuer-name" placeholder="e.g., keycloak" title="Unique identifier for this issuer configuration. Use alphanumeric characters and hyphens only.">');n.append(i),t&&i.val(t);const o=a('<button class="remove-issuer-button" title="Delete this issuer configuration">Remove</button>');s.append(o);const r=async()=>{const l=i.val()||"Unnamed Issuer";await et(l,()=>{e(l)})};return o.on("click",r),s},St=()=>{const t=a('<div class="jwks-button-wrapper"></div>'),e=a('<button type="button" class="verify-jwks-button" title="Test connectivity to the JWKS endpoint and verify it returns valid keys">Test Connection</button>'),s=`<em>${T["jwksValidator.initialInstructions"]||"Click the button to validate JWKS"}</em>`,n=a('<div class="verification-result"></div>');return n.html(s),t.append(e).append(n),{$testButtonWrapper:t,$testButton:e,$resultContainer:n}},wt=(t,e)=>{const s=t.find(".field-jwks-url").closest(".form-field");s.length?s.after(e):t.append(e)},be=(t,e)=>{e.valid?t.html(ie(e.keyCount)):S(t,{responseJSON:e},T,"processor.jwt.invalidJwks")},oe=(t,e,s=!0)=>{if(Y()){const n=s?ie(3,!0):ie(3,!0)+" <em>(Simulated error path response)</em>";t.html(n)}else S(t,e,T,"processor.jwt.validationError")},Se=(t,e)=>{try{a.ajax({method:"POST",url:w.ENDPOINTS.JWKS_VALIDATE_URL,data:JSON.stringify({jwksValue:t}),contentType:"application/json",dataType:"json",timeout:w.TIMEOUTS.DEFAULT}).then(s=>be(e,s)).catch(s=>oe(e,s,!0))}catch(s){oe(e,s,!1)}},Lt=(t,e)=>{const{$testButtonWrapper:s,$testButton:n,$resultContainer:i}=St();wt(t,s);const o=()=>{i.html(T["processor.jwt.testing"]||"Testing...");const r=e();Se(r,i)};n.on("click",o)},Ot=(t,e=null)=>{const n=a(`<button class="save-issuer-button" title="${e?"Save this issuer configuration to the NiFi processor":"Validate and save this issuer configuration (standalone mode)"}">Save Issuer</button>`),i=a('<div class="issuer-form-error-messages"></div>'),o=()=>{i.empty(),ke(t[0],i,e)};return n.on("click",o),t.append(i),n},Rt=(t,e)=>{M(t,"issuer","Issuer URI","The URI of the token issuer (must match the iss claim)",e?e.issuer:"",'This value must exactly match the "iss" claim in JWT tokens. Example: https://auth.example.com/auth/realms/myrealm'),M(t,"jwks-url","JWKS URL","The URL of the JWKS endpoint",e?e["jwks-url"]:"","URL providing public keys for JWT signature verification. Usually ends with /.well-known/jwks.json"),Lt(t,()=>{const s=t.find(".field-jwks-url");return s.length?s.val():""}),M(t,"audience","Audience","The expected audience claim value",e?e.audience:"",'Optional: Expected "aud" claim value in JWT tokens. Leave blank to accept any audience.'),M(t,"client-id","Client ID","The client ID for token validation",e?e["client-id"]:"",'Optional: Expected "azp" or "client_id" claim value. Used for additional token validation.')},kt=(t,e,s=null)=>{const n=a('<div class="issuer-form"></div>'),i=bt(t,l=>{Ne(n[0],l)});n.append(i);const o=a('<div class="form-fields"></div>');n.append(o),Rt(o,e);const r=Ot(n,s);return n.append(r),n},P=(t,e,s,n=null)=>{const i=kt(e,s,n);t.append(i)},M=(t,e,s,n,i,o)=>{const r={name:e,label:s,description:n,value:i||"",placeholder:n,type:"text",required:!1,cssClass:"issuer-config-field",helpText:o||null,validation:e==="jwks-url"||e==="issuer"?p=>p!=null&&p.trim()?{isValid:!0}:{isValid:!1,error:"This field is required"}:null},l=ot.createField(r),c=t instanceof Element?t:t[0];c&&c.appendChild(l)},we=t=>{if(!t.issuerName)return{isValid:!1,error:new Error(T["issuerConfigEditor.error.issuerNameRequired"]||"Issuer name is required.")};const s={issuer:t.issuer,"jwks-url":t["jwks-url"],audience:t.audience,"client-id":t["client-id"]};if(!s.issuer||!s["jwks-url"])return{isValid:!1,error:new Error(T["issuerConfigEditor.error.requiredFields"]||"Issuer URI and JWKS URL are required.")};const n=ft(t);return n.isValid||console.debug("Enhanced validation warnings:",n.error),{isValid:!0}},Le=(t,e)=>{const s={issuer:e.issuer,"jwks-url":e["jwks-url"],audience:e.audience,"client-id":e["client-id"]},n={};return Object.keys(s).forEach(i=>{s[i]&&(n[`issuer.${t}.${i}`]=s[i])}),n},Oe=async(t,e,s,n)=>{try{await Ie(t,s),H(n,T["issuerConfigEditor.success.saved"]||"Issuer configuration saved successfully.")}catch(i){S(n,i,T,"issuerConfigEditor.error.saveFailedTitle")}},Re=t=>{H(t,T["issuerConfigEditor.success.savedStandalone"]||"Issuer configuration saved successfully (standalone mode).")},ke=async(t,e,s=null)=>{e.empty();const n=a(t),i=_e(n),o=we(i);if(!o.isValid){S(e,o.error,T,"issuerConfigEditor.error.title");return}const r=i.issuerName,l=Le(r,i);s?await Oe(s,r,l,e):Re(e)},At=(t,e)=>{const s={};return Object.keys(t).forEach(n=>{n.startsWith(`issuer.${e}.`)&&(s[n]=null)}),s},Ae=(t,e,s=!1)=>{if(!t)return;const n=s?`Issuer "${e}" removed (standalone mode).`:`Issuer "${e}" removed successfully.`;H(t,n),t.show()},Ce=(t,e)=>{if(t){const s=typeof e=="string"?new Error(e):e;S(t,s,T,"issuerConfigEditor.error.removeFailedTitle"),t.show()}else{const s=typeof e=="string"?e:e.message;console.error("Failed to remove issuer:",s)}},Ct=async(t,e,s)=>{try{const i=(await se(t)).properties||{},o=At(i,e);if(Object.keys(o).length===0&&e!=="sample-issuer"){console.info(`No properties found to remove for issuer: ${e}`);return}await Ie(t,o),Ae(s,e,!1)}catch(n){Ce(s,n)}},Ne=async(t,e)=>{a(t).remove();const s=F(window.location.href),n=e,i=Tt();n&&s?await Ct(s,n,i):n&&!s?Ae(i,n,!0):Ce(i,n?"Cannot remove issuer: no processor context found":"Issuer name missing for removal")},Nt=(t,e)=>t?!0:(typeof e=="function"&&e(),!1),Ut=t=>t||window.location.href,Vt=t=>{const s=`issuer-config-editor-${F(t)||"standalone"}`;setTimeout(()=>{j=new gt(s),j.initialize(async()=>{})},0)},Ue=t=>{typeof t=="function"&&t()},Dt=Object.freeze(Object.defineProperty({__proto__:null,__test_exports:{saveIssuer:ke,removeIssuer:Ne,addIssuerForm:P,addFormField:M,getProcessorIdFromUrl:F,_parseIssuerProperties:ye,_extractFieldValue:ht,_extractFormFields:_e,_validateIssuerFormData:we,_createPropertyUpdates:Le,_saveIssuerToServer:Oe,_saveIssuerStandalone:Re,_handleJwksValidationResponse:be,_handleJwksValidationError:oe,_performJwksValidation:Se},cleanup:()=>{j&&(j.destroy(),j=null)},init:async(t,e,s)=>{if(Nt(t,e))try{const n=Ut(s);Vt(n),await yt(t,n),Ue(e)}catch(n){console.debug(n),Ue(e)}}},Symbol.toStringTag,{value:"Module"}));let Ve="en";const De=["en","de"],xt=function(){const e=(navigator.language||navigator.userLanguage||"en").split("-")[0];return De.includes(e)?e:"en"},jt=function(t){return De.includes(t)?(Ve=t,!0):!1},Ft=function(){return Ve};jt(xt());function z(t,e={},s=document){var r;if(t==null)return null;let n;if(typeof t=="string"?n=s.querySelectorAll(t):Array.isArray(t)?n=t:n=[t],n.length===0)return null;const o={...{placement:"bottom-start",arrow:!0,theme:"light-border",appendTo:"parent"},...e};try{return ze(Array.from(n),o)}catch(l){return(r=y==null?void 0:y.logError)==null||r.call(y,"Error initializing tooltip: "+l.message),null}}const Pt={"ctrl+enter":"verify-token","cmd+enter":"verify-token","alt+v":"verify-token","ctrl+1":"goto-tab-1","ctrl+2":"goto-tab-2","ctrl+3":"goto-tab-3","cmd+1":"goto-tab-1","cmd+2":"goto-tab-2","cmd+3":"goto-tab-3","ctrl+s":"save-form","cmd+s":"save-form","alt+r":"reset-form",escape:"close-dialog",f1:"show-help","?":"show-help"},Mt=new Map,xe=()=>{Fe(),a(document).on("keydown.nifi-jwt-shortcuts",zt),Yt()},zt=t=>{const e=je(t),s=Pt[e];s&&Bt(t)&&(t.preventDefault(),t.stopPropagation(),Kt(s))},je=t=>{const e=[];(t.ctrlKey||t.metaKey)&&e.push(t.ctrlKey?"ctrl":"cmd"),t.altKey&&e.push("alt"),t.shiftKey&&e.push("shift");const s=t.key.toLowerCase();return s==="enter"?e.push("enter"):s==="escape"?e.push("escape"):s==="f1"?e.push("f1"):s.match(/^[a-z0-9?]$/)&&e.push(s),e.join("+")},Bt=t=>{const s=t.target.tagName.toLowerCase();if(s==="input"||s==="textarea"){const n=je(t);return n==="ctrl+enter"||n==="cmd+enter"||n==="escape"}return!0},Kt=t=>{switch(t){case"verify-token":Jt();break;case"goto-tab-1":case"goto-tab-2":case"goto-tab-3":Wt(parseInt(t.split("-")[2])-1);break;case"save-form":Ht();break;case"reset-form":$t();break;case"close-dialog":Gt();break;case"show-help":qt();break;default:console.debug("Unknown keyboard shortcut action:",t)}},Jt=()=>{const t=a(".verify-token-button:visible:not(:disabled)");t.length>0&&(t.trigger("click"),B("Token verification started"))},Wt=t=>{const e=a(".tab-nav-item");e.length>t&&(a(e[t]).trigger("click"),B(`Switched to tab ${t+1}`))},Ht=()=>{const t=a('button:contains("Save"):visible:not(:disabled), button:contains("Apply"):visible:not(:disabled)');t.length>0&&(t.first().trigger("click"),B("Form save triggered"))},$t=()=>{const t=a('button:contains("Reset"):visible:not(:disabled), button:contains("Clear"):visible:not(:disabled)');t.length>0&&(t.first().trigger("click"),B("Form reset triggered"))},Gt=()=>{const t=a('.ui-dialog-titlebar-close:visible, button:contains("Cancel"):visible, button:contains("Close"):visible');t.length>0&&(t.first().trigger("click"),B("Dialog closed"))},qt=()=>{const e=a(`
        <div class="keyboard-shortcuts-modal">
            <div class="modal-overlay"></div>
            <div class="modal-content">
                
        <div class="keyboard-shortcuts-help">
            <h3>Keyboard Shortcuts</h3>
            <div class="shortcuts-grid">
                <div class="shortcut-group">
                    <h4>Token Verification</h4>
                    <div class="shortcut-item">
                        <kbd>Ctrl</kbd>+<kbd>Enter</kbd> or <kbd>Alt</kbd>+<kbd>V</kbd>
                        <span>Verify Token</span>
                    </div>
                </div>
                <div class="shortcut-group">
                    <h4>Navigation</h4>
                    <div class="shortcut-item">
                        <kbd>Ctrl</kbd>+<kbd>1</kbd><kbd>2</kbd><kbd>3</kbd>
                        <span>Switch Tabs</span>
                    </div>
                </div>
                <div class="shortcut-group">
                    <h4>Forms</h4>
                    <div class="shortcut-item">
                        <kbd>Ctrl</kbd>+<kbd>S</kbd>
                        <span>Save Form</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>Alt</kbd>+<kbd>R</kbd>
                        <span>Reset Form</span>
                    </div>
                </div>
                <div class="shortcut-group">
                    <h4>General</h4>
                    <div class="shortcut-item">
                        <kbd>Esc</kbd>
                        <span>Close Dialog</span>
                    </div>
                    <div class="shortcut-item">
                        <kbd>F1</kbd> or <kbd>?</kbd>
                        <span>Show Help</span>
                    </div>
                </div>
            </div>
        </div>
    
                <button class="close-help-btn">Close</button>
            </div>
        </div>
    `);a("body").append(e),e.find(".close-help-btn, .modal-overlay").on("click",()=>{e.remove()})},B=t=>{const e=a(`
        <div class="keyboard-action-feedback">
            ${t}
        </div>
    `);a("body").append(e),setTimeout(()=>{e.addClass("fade-out"),setTimeout(()=>e.remove(),300)},2e3)},Yt=()=>{sessionStorage.getItem("nifi-jwt-shortcuts-shown")||setTimeout(()=>{const t=a(`
            <div class="shortcuts-hint">
                <span>ðŸ’¡ Press <kbd>F1</kbd> or <kbd>?</kbd> for keyboard shortcuts</span>
                <button class="close-hint">Ã—</button>
            </div>
        `);a("body").append(t),t.find(".close-hint").on("click",()=>t.remove()),setTimeout(()=>{t.addClass("fade-out"),setTimeout(()=>t.remove(),300)},5e3),sessionStorage.setItem("nifi-jwt-shortcuts-shown","true")},2e3)},Fe=()=>{a(document).off("keydown.nifi-jwt-shortcuts"),Mt.clear(),a(".keyboard-shortcuts-modal, .keyboard-action-feedback, .shortcuts-hint").remove()},u=Je("NiFi-Main"),Zt=()=>{try{return Ft(),y.registerCustomUiTab($.COMPONENT_TABS.ISSUER_CONFIG,Dt),y.registerCustomUiTab($.COMPONENT_TABS.TOKEN_VERIFICATION,lt),window.jwtComponentsRegistered=!0,!0}catch(t){return console.error("JWT UI component registration failed:",t),!1}},re=()=>{try{a(d.SELECTORS.PROPERTY_LABEL).each((t,e)=>{const s=a(e).text().trim(),n=G.PROPERTY_LABELS[s];if(n&&a(e).find(d.SELECTORS.HELP_TOOLTIP).length===0){const i=y.getI18n().getProperty(n);if(i){const o=a(`<span class="${d.CLASSES.HELP_TOOLTIP} ${d.CLASSES.FA} ${d.CLASSES.FA_QUESTION_CIRCLE}"></span>`);o.attr("title",i),a(e).append(o)}}}),z(d.SELECTORS.HELP_TOOLTIP),z("[title]",{placement:"bottom"}),z(".help-tooltip",{placement:"right"}),Qt(),Xt()}catch(t){u.debug("JWT UI help tooltips setup failed:",t)}},Xt=()=>{if(typeof MutationObserver<"u"){const e=new MutationObserver(s=>{let n=!1;s.forEach(i=>{i.type==="childList"&&i.addedNodes.forEach(o=>{var r;if(o.nodeType===Node.ELEMENT_NODE){const l=((r=o.textContent)==null?void 0:r.trim())||"";(l.includes("Loading JWT")||l.includes("Loading Validator")||l.includes("Loading JWT Validator UI"))&&(n=!0)}})}),n&&(u.debug("MutationObserver detected loading message, hiding immediately"),L())});e.observe(document.body,{childList:!0,subtree:!0,characterData:!0}),window.jwtLoadingObserver=e}const t=setInterval(()=>{var s,n;((n=(s=document.querySelector("*"))==null?void 0:s.innerText)==null?void 0:n.includes("Loading JWT Validator UI"))&&(u.debug("Periodic check detected loading message, hiding immediately"),L())},100);setTimeout(()=>{clearInterval(t),u.debug("Periodic loading check completed")},1e4),u.debug("Continuous loading monitoring set up successfully")},Qt=()=>{try{const t=new MutationObserver(e=>{e.forEach(s=>{s.type==="childList"&&s.addedNodes.forEach(n=>{if(n.nodeType===Node.ELEMENT_NODE){const i=a(n),o=i.find("[title]"),r=i.find(".help-tooltip");o.length>0&&z(o.get(),{placement:"bottom"}),r.length>0&&z(r.get(),{placement:"right"})}})})});t.observe(document.body,{childList:!0,subtree:!0}),window.nifiJwtTooltipObserver||(window.nifiJwtTooltipObserver=t)}catch(t){console.debug("Failed to setup tooltip observer:",t)}},J=()=>{try{const t=document.getElementById(d.IDS.LOADING_INDICATOR);if(t)t.style.display="none",t.style.visibility="hidden",t.setAttribute("aria-hidden","true"),t.classList.add("hidden"),t.style.removeProperty&&(t.style.removeProperty("display"),t.style.display="none"),u.debug("Loading indicator successfully hidden");else{const s=document.querySelector('#loading-indicator, .loading-indicator, [id*="loading"]');s&&(s.style.display="none",s.style.visibility="hidden")}const e=document.getElementById(d.IDS.JWT_VALIDATOR_TABS);e&&(e.style.display="",e.style.visibility="visible"),ae(),window.jwtUISetupComplete=!0}catch(t){console.error("Error in setupUI():",t);try{const e=document.getElementById("loading-indicator");e&&(e.style.display="none")}catch(e){console.error("Even fallback setupUI failed:",e)}}},ae=()=>{const t=y.getI18n(),e=a(`#${d.IDS.LOADING_INDICATOR}`);e.length&&e.text(t.getProperty(G.I18N_KEYS.JWT_VALIDATOR_LOADING)||"Loading...");const s=a(d.SELECTORS.JWT_VALIDATOR_TITLE);s.length&&s.text(t.getProperty(G.I18N_KEYS.JWT_VALIDATOR_TITLE)||"JWT Validator")},es=()=>{a(document).on("dialogOpen",(t,e)=>{var i;const s=Array.isArray(e)?e[0]:e;((i=s==null?void 0:s.classList)==null?void 0:i.contains(d.CLASSES.PROCESSOR_DIALOG))&&setTimeout(()=>{var r,l;const o=(l=(r=s.querySelector(d.SELECTORS.PROCESSOR_TYPE))==null?void 0:r.textContent)==null?void 0:l.trim();o!=null&&o.includes($.PROCESSOR_TYPES.MULTI_ISSUER_JWT_AUTHENTICATOR)&&(re(),ae())},w.TIMEOUTS.DIALOG_DELAY)})},ts=()=>new Promise(t=>{try{if(u.debug("JWT UI initialization starting..."),window.jwtInitializationInProgress||window.jwtUISetupComplete){u.debug("Initialization already in progress or complete, skipping"),t(!0);return}window.jwtInitializationInProgress=!0,u.info("PRIORITY: Hiding loading indicator immediately"),L(),u.debug("Registering JWT UI components...");const e=Zt();e?(u.debug("Component registration successful, setting up UI..."),J(),ce(),es(),xe(),u.info("JWT UI initialization completed successfully")):(console.warn("Component registration failed, using fallback..."),J(),ce(),xe()),setTimeout(()=>{u.debug("100ms safety check: ensuring loading indicator is hidden"),L()},100),setTimeout(()=>{u.debug("500ms safety check: ensuring loading indicator is hidden"),L()},500),setTimeout(()=>{u.debug("Final 1s fallback: ensuring UI is visible and loading hidden"),J(),L(),ae()},w.TIMEOUTS.DIALOG_DELAY),window.jwtInitializationInProgress=!1,t(e)}catch(e){console.error("JWT UI initialization failed:",e),L(),J(),window.jwtInitializationInProgress=!1,t(!1)}}),L=()=>{try{u.debug("hideLoadingIndicatorRobust: Starting comprehensive loading indicator removal"),ss(),ns(),is(),window.jwtLoadingIndicatorHidden=!0,window.jwtHideLoadingIndicator=L,u.debug("hideLoadingIndicatorRobust: Comprehensive loading indicator removal completed")}catch(t){console.warn("Error in hideLoadingIndicatorRobust:",t),Me()}},ss=()=>{const t=document.getElementById(d.IDS.LOADING_INDICATOR);if(t){const e=t.textContent;t.style.setProperty("display","none","important"),t.style.setProperty("visibility","hidden","important"),t.style.setProperty("opacity","0","important"),t.setAttribute("aria-hidden","true"),t.classList.add("hidden"),t.textContent="",t.innerHTML="",u.debug(`Loading indicator hidden via standard ID (was: "${e}")`)}},ns=()=>{["#loading-indicator",".loading-indicator",'[id*="loading"]','[class*="loading"]'].forEach(e=>{try{document.querySelectorAll(e).forEach(n=>{n.style.setProperty("display","none","important"),n.style.setProperty("visibility","hidden","important"),n.style.setProperty("opacity","0","important"),n.setAttribute("aria-hidden","true"),n.classList.add("hidden")})}catch(s){console.debug("Selector ignored:",e,s)}})},is=()=>{var i;const t=document.getElementsByTagName("*"),e=["Loading JWT Validator UI","Loading JWT","Loading"];let s=0;u.debug("hideLoadingByTextContent: Starting scan of",t.length,"elements");for(const o of t){const r=((i=o.textContent)==null?void 0:i.trim())||"";e.some(c=>r.includes(c))&&(u.debug("Found element with loading text:",r,"on element:",o.tagName,o.id,o.className),Pe(r)?(le(o,r),s++):u.debug("Element not hidden because shouldHideElement returned false"))}["loading-indicator","simulated-loading","jwt-loading","validator-loading"].forEach(o=>{var l,c;const r=document.getElementById(o);r&&(u.debug(`Found element with ID ${o}:`,(l=r.textContent)==null?void 0:l.trim()),(c=r.textContent)!=null&&c.trim().includes("Loading")&&(le(r,r.textContent.trim()),s++))}),u.debug(`hideLoadingByTextContent: Hidden ${s} loading indicators`)},Pe=t=>{u.debug("shouldHideElement checking:",t);const e=t.length<100&&(t==="Loading JWT Validator UI..."||t.startsWith("Loading JWT")||t.startsWith("Loading"));return u.debug("shouldHideElement result:",e),e},le=(t,e)=>{t.style.setProperty("display","none","important"),t.style.setProperty("visibility","hidden","important"),t.style.setProperty("opacity","0","important"),t.setAttribute("aria-hidden","true"),t.classList.add("hidden"),t.childNodes.length===1&&t.childNodes[0].nodeType===Node.TEXT_NODE&&(t.textContent=""),u.debug(`Hidden element with loading text: "${e}"`)},Me=()=>{try{const t=document.getElementById("loading-indicator");t&&(t.style.display="none",u.debug("Emergency fallback: basic loading indicator hidden"))}catch(t){console.error("Even emergency fallback failed:",t)}},os=()=>{try{a(document).off("dialogOpen"),Fe(),window.nifiJwtTooltipObserver&&(window.nifiJwtTooltipObserver.disconnect(),window.nifiJwtTooltipObserver=null),window.jwtLoadingObserver&&(window.jwtLoadingObserver.disconnect(),window.jwtLoadingObserver=null)}catch(t){console.debug(t)}},rs=()=>[{id:"issuer-config-editor",status:"registered"},{id:"token-verifier",status:"registered"},{id:"help-tooltips",status:"registered"}],ce=re;g.cleanup=os,g.emergencyFallbackHideLoading=Me,g.getComponentStatus=rs,g.hideElement=le,g.hideLoadingIndicatorRobust=L,g.init=ts,g.registerHelpTooltips=ce,g.setupHelpTooltips=re,g.shouldHideElement=Pe,Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});
