= Project Overview
:toc: left
:toclevels: 3
:toc-title: Table of Contents
:sectnums:
:source-highlighter: highlight.js

== Purpose

This document provides an overview of the NiFi integration testing framework for custom processor validation using Cypress.

== Testing Philosophy

*We use NiFi as a platform to test our custom processor logic. We don't test NiFi itself.*

=== Testing Focus Areas

The framework focuses on testing:

* **JWT validation logic** in our custom processors
* **Multi-issuer configuration handling** 
* **Error handling and edge cases** in our code

We explicitly avoid testing:

* NiFi's authentication system
* NiFi's navigation mechanics  
* NiFi's processor framework

=== Why This Approach?

1. **Focus on Value**: Test the custom logic we've built, not the platform
2. **Reliability**: Avoid brittle tests that break when NiFi updates
3. **Efficiency**: Target testing efforts where bugs are most likely
4. **Maintainability**: Keep tests stable across NiFi version changes

== Technology Stack

=== Core Technologies

* **Test Framework**: Cypress 14.4.1 with custom commands
* **Target Application**: NiFi 2.4.0 with Angular 19.2.14 UI
* **Authentication**: Built-in NiFi authentication with test credentials
* **Infrastructure**: Docker with docker-compose for consistency
* **Build System**: Maven with Node.js integration via frontend-maven-plugin
* **CI/CD**: GitHub Actions with automated testing and reporting

=== Framework Architecture

The testing framework uses a **helper-based architecture** with clear separation of concerns:

[source]
----
cypress/
├── e2e/                    # Actual test scenarios
├── support/                # Reusable helper modules
│   ├── auth-helper.js      # Authentication management
│   ├── navigation-helper.js # Page navigation and detection
│   ├── processor-helper.js # Processor lifecycle operations
│   ├── constants.js        # Shared selectors and constants
│   └── utils.js           # Utility functions
└── fixtures/              # Test data and mock responses
----

=== Key Design Principles

1. **Command-based approach**: Reusable commands for common operations
2. **Self-verification**: Commands are tested independently
3. **Error resilience**: Graceful handling of failures with detailed reporting
4. **Maintainability**: Clear structure and comprehensive documentation

== Current Status

The e-2-e-cypress module is **production-ready** with comprehensive capabilities:

* ✅ **15+ custom Cypress commands** for NiFi automation
* ✅ **Complete authentication and navigation** reliability 
* ✅ **Angular 2.4.0 UI compatibility** with robust selectors
* ✅ **Docker environment integration** for consistent testing
* ✅ **Maven build integration** with Node.js 20.19.2
* ✅ **Full CI/CD pipeline** with GitHub Actions
* ✅ **Zero-warning ESLint implementation** following centralized standards

== Development Workflow

=== Verification Strategy

All development follows a **fail-fast verification approach**:

[source,bash]
----
# 1. Full build verification (required)
./mvnw clean verify

# 2. Integration tests (required)  
./mvnw clean verify -pl e-2-e-cypress -Pintegration-tests
----

Both commands must pass before committing any changes.

=== Implementation Approach

1. **Make small incremental changes**
2. **Immediately verify** with both Maven commands
3. **Fix failures immediately** with focused debugging
4. **Commit only after success** to maintain build integrity
5. **Repeat for next change** to maintain momentum

This ensures immediate feedback, smaller debug scope, and reliable builds.

== Basic Usage

=== Quick Start Commands

[source,bash]
----
# Run tests headlessly
npm run cypress:run

# Interactive development
npm run cypress:open

# Full integration test
./mvnw clean verify -pl e-2-e-cypress -Pintegration-tests
----

=== Example Test Structure

[source,javascript]
----
describe('Processor Testing', () => {
  beforeEach(() => {
    // Authentication and setup
    cy.ensureNiFiReady();
  });

  it('should test custom processor logic', () => {
    // Focus on OUR processor, not NiFi
    cy.addProcessorToCanvas('MultiIssuerJWTTokenAuthenticator')
      .then((processor) => {
        // Test our custom JWT validation logic
        cy.configureJWTValidator(processor, {
          issuer: 'https://example.com',
          audience: 'test-audience'
        });
        
        // Verify our configuration handling
        cy.verifyJWTConfiguration(processor);
      });
  });
});
----

== See Also

* xref:README.adoc[Documentation Index] - Complete documentation overview
* xref:setup-guide.adoc[Setup Guide] - Environment setup and configuration
* xref:testing-patterns.adoc[Testing Patterns] - Practical examples and implementation patterns
* xref:architecture.adoc[Technical Architecture] - Infrastructure and implementation details
